<div class="edit-article-container">

  <div *ngIf="!isLoading && articulo" class="edit-form-container">
    <div class="page-header">
      <h1>Editar Producto</h1>
    </div>
    <div class="article-info-card">
      <div class="info-grid">
        <div class="info-item">
          <label>ID:</label>
          <span class="info-value">{{ articulo.id }}</span>
        </div>
        <div class="info-item">
          <label>Estado de aprobacion:</label>
          {{ getEstadoAprobacionTexto(articulo.estadoAprobacion) }}
        </div>
      </div>
    </div>
    <div class="form-card">
      <form [formGroup]="editForm" (ngSubmit)="onSubmit()">
        <div class="form-grid">
          <div class="form-group">
            <label for="nombre" class="form-label">Nombre del Producto</label>
            <input type="text" id="nombre" formControlName="nombre" class="form-input"
              [class.input-error]="editForm.get('nombre')?.invalid && editForm.get('nombre')?.touched" maxlength="200">
            <div class="error-message"
              *ngIf="editForm.get('nombre')?.errors?.['required'] && editForm.get('nombre')?.touched">
              El nombre del producto es obligatorio
            </div>
            <div class="error-message"
              *ngIf="editForm.get('nombre')?.errors?.['maxlength'] && editForm.get('nombre')?.touched">
              El nombre no puede tener mas de 200 caracteres
            </div>
          </div>
          <div class="form-group">
            <label for="categoria" class="form-label">Categoria</label>
            <select id="categoria" formControlName="categoria" class="form-select"
              [class.input-error]="editForm.get('categoria')?.invalid && editForm.get('categoria')?.touched">
              <option value="">Selecciona una categoria</option>
              <option *ngFor="let categoria of categorias" [value]="categoria">
                {{ categoria }}
              </option>
            </select>
            <div class="error-message"
              *ngIf="editForm.get('categoria')?.errors?.['required'] && editForm.get('categoria')?.touched">
              La categoria es obligatoria
            </div>
          </div>
          <div class="form-group">
            <label for="estadoArticulo" class="form-label">Estado del Producto</label>
            <select id="estadoArticulo" formControlName="estadoArticulo" class="form-select"
              [class.input-error]="editForm.get('estadoArticulo')?.invalid && editForm.get('estadoArticulo')?.touched">
              <option value="">Selecciona el estado</option>
              <option *ngFor="let estado of estadosArticulo" [value]="estado.value">
                {{ estado.label }}
              </option>
            </select>
            <div class="error-message"
              *ngIf="editForm.get('estadoArticulo')?.errors?.['required'] && editForm.get('estadoArticulo')?.touched">
              El estado del producto es obligatorio
            </div>
          </div>
          <div class="form-group">
            <label for="precio" class="form-label">Precio</label>
            <input type="number" id="precio" formControlName="precio" class="form-input"
              [class.input-error]="editForm.get('precio')?.invalid && editForm.get('precio')?.touched"
              placeholder="0.00" step="0.01" min="0.01">
            <div class="error-message"
              *ngIf="editForm.get('precio')?.errors?.['required'] && editForm.get('precio')?.touched">
              El precio es obligatorio
            </div>
            <div class="error-message"
              *ngIf="editForm.get('precio')?.errors?.['min'] && editForm.get('precio')?.touched">
              El precio debe ser mayor a 0
            </div>
          </div>
          <div class="form-group">
            <label for="stock" class="form-label">Stock Disponible</label>
            <input type="number" id="stock" formControlName="stock" class="form-input"
              [class.input-error]="editForm.get('stock')?.invalid && editForm.get('stock')?.touched" min="1">
            <div class="error-message"
              *ngIf="editForm.get('stock')?.errors?.['required'] && editForm.get('stock')?.touched">
              El stock es obligatorio
            </div>
            <div class="error-message" *ngIf="editForm.get('stock')?.errors?.['min'] && editForm.get('stock')?.touched">
              El stock minimo es 1
            </div>
          </div>
        </div>
        <div class="form-group full-width">
          <label for="descripcion" class="form-label">Descripcion del Producto</label>
          <textarea id="descripcion" formControlName="descripcion" class="form-textarea"
            [class.input-error]="editForm.get('descripcion')?.invalid && editForm.get('descripcion')?.touched" rows="4"
            maxlength="250"></textarea>
          <div class="error-message"
            *ngIf="editForm.get('descripcion')?.errors?.['required'] && editForm.get('descripcion')?.touched">
            La descripcion es obligatoria
          </div>
          <div class="error-message"
            *ngIf="editForm.get('descripcion')?.errors?.['maxlength'] && editForm.get('descripcion')?.touched">
            La descripcion no puede tener mas de 250 caracteres
          </div>
        </div>
        <div class="form-actions">
          <button type="button" class="btn-cancel" (click)="volverAMisProductos()" [disabled]="isSubmitting">
            Cancelar
          </button>
          <button type="submit" class="btn-submit" [disabled]="editForm.invalid || isSubmitting">
            <span *ngIf="isSubmitting" class="loading-spinner"></span>
            {{ isSubmitting ? 'Actualizando...' : 'Actualizar' }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>